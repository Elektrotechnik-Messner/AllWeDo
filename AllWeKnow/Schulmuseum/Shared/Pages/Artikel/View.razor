
@page "/artikel/{PostId}"

@using DatabaseLibrary
@using Schulmuseum.Models
@using Microsoft.Extensions.Configuration

@inject DataAccess Data



@if (string.IsNullOrEmpty(PostId))
{
    <NotFound/>
}
else
{
    <LazyLoader Load="Load" Text="Wird geladen...">
            @{
                var content = _content![0].Content;
                @if (content != null)
                {
                    @ToRawHtml(content)
                }
            }
    </LazyLoader>
}

@code {

    [Parameter]
    public string? PostId { get; set; }

    List<BlogPost>? _content;
    LazyLoader? LazyLoader;

    private async Task Load(LazyLoader arg)
    {
    // Get all the content of the blog by id from the database
        _content = await Data.LoadData<BlogPost, dynamic>("SELECT * FROM posts WHERE id = " + PostId, new { }, Config.GetConnectionString("main"));
    }

    public static MarkupString ToRawHtml(string html)
    {
        return (MarkupString)html;
    }

}